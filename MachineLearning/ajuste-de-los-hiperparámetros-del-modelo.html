<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4 Ajuste de los hiperparámetros del modelo | PRÁCTICA MACHINE LEARNING I</title>
  <meta name="description" content="4 Ajuste de los hiperparámetros del modelo | PRÁCTICA MACHINE LEARNING I" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="4 Ajuste de los hiperparámetros del modelo | PRÁCTICA MACHINE LEARNING I" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4 Ajuste de los hiperparámetros del modelo | PRÁCTICA MACHINE LEARNING I" />
  
  
  

<meta name="author" content="Amanda Del Álamo Caballero y Alejandro Delgado Peribáñez" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="análisis-supervisado.html"/>
<link rel="next" href="evaluación-y-comparación-de-modelos.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="introducción.html"><a href="introducción.html"><i class="fa fa-check"></i><b>1</b> Introducción</a></li>
<li class="chapter" data-level="2" data-path="análisis-no-supervisado.html"><a href="análisis-no-supervisado.html"><i class="fa fa-check"></i><b>2</b> Análisis no supervisado</a>
<ul>
<li class="chapter" data-level="2.1" data-path="análisis-no-supervisado.html"><a href="análisis-no-supervisado.html#análisis-de-componentes-principales"><i class="fa fa-check"></i><b>2.1</b> Análisis de componentes principales</a></li>
<li class="chapter" data-level="2.2" data-path="análisis-no-supervisado.html"><a href="análisis-no-supervisado.html#k-medias.-análisis-cluster-no-jerárquico-o-de-conglomerados-clustering"><i class="fa fa-check"></i><b>2.2</b> k-medias. Análisis <em>cluster</em> no jerárquico o de conglomerados (<em>clustering</em>)</a></li>
<li class="chapter" data-level="2.3" data-path="análisis-no-supervisado.html"><a href="análisis-no-supervisado.html#clustering-jerárquico"><i class="fa fa-check"></i><b>2.3</b> Clustering jerárquico</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="análisis-supervisado.html"><a href="análisis-supervisado.html"><i class="fa fa-check"></i><b>3</b> Análisis supervisado</a>
<ul>
<li class="chapter" data-level="3.1" data-path="análisis-supervisado.html"><a href="análisis-supervisado.html#regresión-logística"><i class="fa fa-check"></i><b>3.1</b> Regresión logística</a></li>
<li class="chapter" data-level="3.2" data-path="análisis-supervisado.html"><a href="análisis-supervisado.html#los-k-vecinos-más-cercanos-k-nn-the-k-nearest-neighbours"><i class="fa fa-check"></i><b>3.2</b> Los k-vecinos más cercanos (k-NN: The k-nearest neighbours)</a></li>
<li class="chapter" data-level="3.3" data-path="análisis-supervisado.html"><a href="análisis-supervisado.html#árboles-de-decisión"><i class="fa fa-check"></i><b>3.3</b> Árboles de decisión</a></li>
<li class="chapter" data-level="3.4" data-path="análisis-supervisado.html"><a href="análisis-supervisado.html#bosques-aleatorios"><i class="fa fa-check"></i><b>3.4</b> Bosques aleatorios</a></li>
<li class="chapter" data-level="3.5" data-path="análisis-supervisado.html"><a href="análisis-supervisado.html#máquinas-de-vectores-de-soporte-svm-support-vector-machines"><i class="fa fa-check"></i><b>3.5</b> Máquinas de vectores de soporte (SVM: Support Vector Machines)</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="análisis-supervisado.html"><a href="análisis-supervisado.html#svm-con-kernel-radial"><i class="fa fa-check"></i><b>3.5.1</b> SVM con kernel radial</a></li>
<li class="chapter" data-level="3.5.2" data-path="análisis-supervisado.html"><a href="análisis-supervisado.html#svm-con-kernel-lineal"><i class="fa fa-check"></i><b>3.5.2</b> SVM con kernel lineal</a></li>
<li class="chapter" data-level="3.5.3" data-path="análisis-supervisado.html"><a href="análisis-supervisado.html#svm-con-kernel-sigmoidal"><i class="fa fa-check"></i><b>3.5.3</b> SVM con kernel sigmoidal</a></li>
<li class="chapter" data-level="3.5.4" data-path="análisis-supervisado.html"><a href="análisis-supervisado.html#svm-con-kernel-polinomial"><i class="fa fa-check"></i><b>3.5.4</b> SVM con kernel polinomial</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="ajuste-de-los-hiperparámetros-del-modelo.html"><a href="ajuste-de-los-hiperparámetros-del-modelo.html"><i class="fa fa-check"></i><b>4</b> Ajuste de los hiperparámetros del modelo</a>
<ul>
<li class="chapter" data-level="4.1" data-path="ajuste-de-los-hiperparámetros-del-modelo.html"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#regresión-logística-1"><i class="fa fa-check"></i><b>4.1</b> Regresión logística</a></li>
<li class="chapter" data-level="4.2" data-path="ajuste-de-los-hiperparámetros-del-modelo.html"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#k-nn"><i class="fa fa-check"></i><b>4.2</b> k-NN</a></li>
<li class="chapter" data-level="4.3" data-path="ajuste-de-los-hiperparámetros-del-modelo.html"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#árboles-de-decisión-1"><i class="fa fa-check"></i><b>4.3</b> Árboles de decisión</a></li>
<li class="chapter" data-level="4.4" data-path="ajuste-de-los-hiperparámetros-del-modelo.html"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#random-forest"><i class="fa fa-check"></i><b>4.4</b> Random Forest</a></li>
<li class="chapter" data-level="4.5" data-path="ajuste-de-los-hiperparámetros-del-modelo.html"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#svm"><i class="fa fa-check"></i><b>4.5</b> SVM</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="evaluación-y-comparación-de-modelos.html"><a href="evaluación-y-comparación-de-modelos.html"><i class="fa fa-check"></i><b>5</b> Evaluación y comparación de modelos</a>
<ul>
<li class="chapter" data-level="5.0.1" data-path="evaluación-y-comparación-de-modelos.html"><a href="evaluación-y-comparación-de-modelos.html#test-de-friedman-para-comparar-el-accuracy-de-los-modelos"><i class="fa fa-check"></i><b>5.0.1</b> Test de Friedman para comparar el accuracy de los modelos</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="curva-de-roc.html"><a href="curva-de-roc.html"><i class="fa fa-check"></i><b>6</b> Curva de ROC</a></li>
<li class="chapter" data-level="7" data-path="gam.html"><a href="gam.html"><i class="fa fa-check"></i><b>7</b> GAM</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">PRÁCTICA MACHINE LEARNING I</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="ajuste-de-los-hiperparámetros-del-modelo" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Ajuste de los hiperparámetros del modelo</h1>
<p>Muchos modelos, entre ellos los árboles de regresión, contienen parámetros que no pueden aprenderse a partir de los datos de entrenamiento y, por lo tanto, deben de ser establecidos por el analista. A estos se les conoce como hiperparámetros. Los resultados de un modelo pueden depender en gran medida del valor que tomen sus hiperparámetros, sin embargo, no se puede conocer de antemano cuál es el adecuado. Aunque con la práctica, los especialistas en machine learning ganan intuición sobre qué valores pueden funcionar mejor en cada problema, no hay reglas fijas. La forma más común de encontrar los valores óptimos es probando diferentes posibilidades.</p>
<ul>
<li><p>Escoger un conjunto de valores para el o los hiperparámetros.</p></li>
<li><p>Para cada valor (combinación de valores si hay más de un hiperparámetro), entrenar el modelo y estimar su error mediante un método de validación</p></li>
<li><p>Finalmente, ajustar de nuevo el modelo, esta vez con todos los datos de entrenamiento y con los mejores hiperparámetros encontrados.</p></li>
</ul>
<div id="regresión-logística-1" class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> Regresión logística</h2>
<p>El método glm de caret emplea la función glm() del paquete básico de R. Este algoritmo no tiene ningún hiperparámetro pero, para que efectúe una regresión logística, hay que indicar family = “binomial”.</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="fu">registerDoMC</span>(<span class="at">cores =</span> <span class="dv">4</span>)</span></code></pre></div>
<p>Se configuran el número de repeticiones y las particiones para cada repetición:</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb144-1" aria-hidden="true" tabindex="-1"></a>particiones  <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb144-2"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb144-2" aria-hidden="true" tabindex="-1"></a>repeticiones <span class="ot">&lt;-</span> <span class="dv">5</span></span></code></pre></div>
<p>Ahora, se ajustan los hiperparámetros:</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb145-1" aria-hidden="true" tabindex="-1"></a>hiperparametros <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">parameter =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb145-2"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb145-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-3"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb145-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb145-4"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb145-4" aria-hidden="true" tabindex="-1"></a>seeds <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">mode =</span> <span class="st">&quot;list&quot;</span>, <span class="at">length =</span> (particiones <span class="sc">*</span> repeticiones) <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb145-5"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb145-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(particiones <span class="sc">*</span> repeticiones)) {</span>
<span id="cb145-6"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb145-6" aria-hidden="true" tabindex="-1"></a>  seeds[[i]] <span class="ot">&lt;-</span> <span class="fu">sample.int</span>(<span class="dv">1000</span>, <span class="fu">nrow</span>(hiperparametros))}</span>
<span id="cb145-7"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb145-7" aria-hidden="true" tabindex="-1"></a>seeds[[(particiones <span class="sc">*</span> repeticiones) <span class="sc">+</span> <span class="dv">1</span>]] <span class="ot">&lt;-</span> <span class="fu">sample.int</span>(<span class="dv">1000</span>, <span class="dv">1</span>)</span></code></pre></div>
<p>Y por último, se define el entrenamiento y se ajusta el modelo:</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="co"># DEFINICIÓN DEL ENTRENAMIENTO</span></span>
<span id="cb146-2"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb146-2" aria-hidden="true" tabindex="-1"></a>control_train <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">&quot;repeatedcv&quot;</span>, <span class="at">number =</span> particiones,</span>
<span id="cb146-3"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb146-3" aria-hidden="true" tabindex="-1"></a>                              <span class="at">repeats =</span> repeticiones, <span class="at">seeds =</span> seeds,</span>
<span id="cb146-4"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb146-4" aria-hidden="true" tabindex="-1"></a>                              <span class="at">returnResamp =</span> <span class="st">&quot;final&quot;</span>, <span class="at">verboseIter =</span> <span class="cn">FALSE</span>,</span>
<span id="cb146-5"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb146-5" aria-hidden="true" tabindex="-1"></a>                              <span class="at">allowParallel =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="co"># AJUSTE DEL MODELO</span></span>
<span id="cb147-2"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb147-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">34220</span>)</span>
<span id="cb147-3"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb147-3" aria-hidden="true" tabindex="-1"></a>modelo_logistic <span class="ot">&lt;-</span> <span class="fu">train</span>(Gama <span class="sc">~</span> ., <span class="at">data =</span> data[,<span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">10</span>,<span class="dv">13</span>,<span class="dv">14</span>,<span class="dv">15</span>)],</span>
<span id="cb147-4"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb147-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">method =</span> <span class="st">&quot;glm&quot;</span>,</span>
<span id="cb147-5"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb147-5" aria-hidden="true" tabindex="-1"></a>                         <span class="at">tuneGrid =</span> hiperparametros,</span>
<span id="cb147-6"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb147-6" aria-hidden="true" tabindex="-1"></a>                         <span class="at">metric =</span> <span class="st">&quot;Accuracy&quot;</span>,</span>
<span id="cb147-7"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb147-7" aria-hidden="true" tabindex="-1"></a>                         <span class="at">trControl =</span> control_train,</span>
<span id="cb147-8"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb147-8" aria-hidden="true" tabindex="-1"></a>                         <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>)</span>
<span id="cb147-9"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb147-9" aria-hidden="true" tabindex="-1"></a>modelo_logistic</span></code></pre></div>
<pre><code>## Generalized Linear Model 
## 
## 4711 samples
##   11 predictor
##    2 classes: &#39;Alta&#39;, &#39;Baja-media&#39; 
## 
## No pre-processing
## Resampling: Cross-Validated (10 fold, repeated 5 times) 
## Summary of sample sizes: 4240, 4239, 4240, 4240, 4239, 4241, ... 
## Resampling results:
## 
##   Accuracy   Kappa    
##   0.9266427  0.8214096</code></pre>
<p>Empleando un modelo de regresión logística se consigue un accuracy promedio de validación del 93%.</p>
</div>
<div id="k-nn" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> k-NN</h2>
<p>Ahora aplicamos la busqueda bayesiana para encontrar el mejor número de vecinos para el k-NN.</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Hiperparámetros</span></span>
<span id="cb149-2"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb149-2" aria-hidden="true" tabindex="-1"></a>hiperparametros <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">k =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">50</span>))</span>
<span id="cb149-3"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb149-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-4"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb149-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb149-5"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb149-5" aria-hidden="true" tabindex="-1"></a>seeds <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">mode =</span> <span class="st">&quot;list&quot;</span>, <span class="at">length =</span> (particiones <span class="sc">*</span> repeticiones) <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb149-6"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb149-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(particiones <span class="sc">*</span> repeticiones)) {</span>
<span id="cb149-7"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb149-7" aria-hidden="true" tabindex="-1"></a>  seeds[[i]] <span class="ot">&lt;-</span> <span class="fu">sample.int</span>(<span class="dv">1000</span>, <span class="fu">nrow</span>(hiperparametros)) </span>
<span id="cb149-8"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb149-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb149-9"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb149-9" aria-hidden="true" tabindex="-1"></a>seeds[[(particiones <span class="sc">*</span> repeticiones) <span class="sc">+</span> <span class="dv">1</span>]] <span class="ot">&lt;-</span> <span class="fu">sample.int</span>(<span class="dv">1000</span>, <span class="dv">1</span>)</span></code></pre></div>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="co"># DEFINICIÓN DEL ENTRENAMIENTO</span></span>
<span id="cb150-2"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb150-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-3"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb150-3" aria-hidden="true" tabindex="-1"></a>control_train <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">&quot;repeatedcv&quot;</span>, <span class="at">number =</span> particiones,</span>
<span id="cb150-4"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb150-4" aria-hidden="true" tabindex="-1"></a>                              <span class="at">repeats =</span> repeticiones, <span class="at">seeds =</span> seeds,</span>
<span id="cb150-5"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb150-5" aria-hidden="true" tabindex="-1"></a>                              <span class="at">returnResamp =</span> <span class="st">&quot;final&quot;</span>, <span class="at">verboseIter =</span> <span class="cn">FALSE</span>,</span>
<span id="cb150-6"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb150-6" aria-hidden="true" tabindex="-1"></a>                              <span class="at">allowParallel =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="co"># AJUSTE DEL MODELO</span></span>
<span id="cb151-2"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb151-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-3"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb151-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">34220</span>)</span>
<span id="cb151-4"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb151-4" aria-hidden="true" tabindex="-1"></a>modelo_knn <span class="ot">&lt;-</span> <span class="fu">train</span>(Gama<span class="sc">~</span> ., <span class="at">data =</span> data[,<span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">10</span>,<span class="dv">13</span>,<span class="dv">14</span>,<span class="dv">15</span>)],</span>
<span id="cb151-5"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb151-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">&quot;knn&quot;</span>,</span>
<span id="cb151-6"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb151-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">tuneGrid =</span> hiperparametros,</span>
<span id="cb151-7"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb151-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">metric =</span> <span class="st">&quot;Accuracy&quot;</span>,</span>
<span id="cb151-8"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb151-8" aria-hidden="true" tabindex="-1"></a>                    <span class="at">trControl =</span> control_train)</span>
<span id="cb151-9"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb151-9" aria-hidden="true" tabindex="-1"></a>modelo_knn</span></code></pre></div>
<pre><code>## k-Nearest Neighbors 
## 
## 4711 samples
##   11 predictor
##    2 classes: &#39;Alta&#39;, &#39;Baja-media&#39; 
## 
## No pre-processing
## Resampling: Cross-Validated (10 fold, repeated 5 times) 
## Summary of sample sizes: 4240, 4239, 4240, 4240, 4239, 4241, ... 
## Resampling results across tuning parameters:
## 
##   k   Accuracy   Kappa    
##    1  0.8794749  0.7056852
##    2  0.8680960  0.6771780
##    5  0.8976852  0.7480572
##   10  0.8866888  0.7157664
##   15  0.8693664  0.6631850
##   20  0.8526423  0.6066279
##   30  0.8244122  0.5050079
##   50  0.7812349  0.3321058
## 
## Accuracy was used to select the optimal model using the largest value.
## The final value used for the model was k = 5.</code></pre>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="co"># REPRESENTACIÓN GRÁFICA</span></span>
<span id="cb153-2"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb153-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(modelo_knn, <span class="at">highlight =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb153-3"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb153-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> hiperparametros<span class="sc">$</span>k) <span class="sc">+</span></span>
<span id="cb153-4"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb153-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Evolución del accuracy del modelo KNN&quot;</span>, <span class="at">x =</span> <span class="st">&quot;K&quot;</span>) <span class="sc">+</span></span>
<span id="cb153-5"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb153-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="MachineLearning1_files/figure-html/unnamed-chunk-39-1.png" width="672" /></p>
<p>Con un modelo k-NN con 5 vecinos se consigue un accuracy de validación promedio del 89’7%.</p>
</div>
<div id="árboles-de-decisión-1" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Árboles de decisión</h2>
<p>Ahora, vamos a realizar el ajuste de hiperparámetros del árbol de decisión, que ya obtenía muy buenas predicciones.</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Hiperparámetros</span></span>
<span id="cb154-2"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb154-2" aria-hidden="true" tabindex="-1"></a>hiperparametros <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">parameter =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb154-3"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb154-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-4"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb154-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb154-5"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb154-5" aria-hidden="true" tabindex="-1"></a>seeds <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">mode =</span> <span class="st">&quot;list&quot;</span>, <span class="at">length =</span> (particiones <span class="sc">*</span> repeticiones) <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb154-6"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb154-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(particiones <span class="sc">*</span> repeticiones)) {</span>
<span id="cb154-7"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb154-7" aria-hidden="true" tabindex="-1"></a>  seeds[[i]] <span class="ot">&lt;-</span> <span class="fu">sample.int</span>(<span class="dv">1000</span>, <span class="fu">nrow</span>(hiperparametros))</span>
<span id="cb154-8"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb154-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb154-9"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb154-9" aria-hidden="true" tabindex="-1"></a>seeds[[(particiones <span class="sc">*</span> repeticiones) <span class="sc">+</span> <span class="dv">1</span>]] <span class="ot">&lt;-</span> <span class="fu">sample.int</span>(<span class="dv">1000</span>, <span class="dv">1</span>)</span></code></pre></div>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="co"># DEFINICIÓN DEL ENTRENAMIENTO</span></span>
<span id="cb155-2"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb155-2" aria-hidden="true" tabindex="-1"></a>control_train <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">&quot;repeatedcv&quot;</span>, <span class="at">number =</span> particiones,</span>
<span id="cb155-3"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb155-3" aria-hidden="true" tabindex="-1"></a>                              <span class="at">repeats =</span> repeticiones, <span class="at">seeds =</span> seeds,</span>
<span id="cb155-4"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb155-4" aria-hidden="true" tabindex="-1"></a>                              <span class="at">returnResamp =</span> <span class="st">&quot;final&quot;</span>, <span class="at">verboseIter =</span> <span class="cn">FALSE</span>,</span>
<span id="cb155-5"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb155-5" aria-hidden="true" tabindex="-1"></a>                              <span class="at">allowParallel =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="co"># AJUSTE DEL MODELO</span></span>
<span id="cb156-2"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb156-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">34220</span>)</span>
<span id="cb156-3"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb156-3" aria-hidden="true" tabindex="-1"></a>modelo_C50Tree <span class="ot">&lt;-</span> <span class="fu">train</span>(Gama<span class="sc">~</span> ., <span class="at">data =</span> data[,<span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">10</span>,<span class="dv">13</span>,<span class="dv">14</span>,<span class="dv">15</span>)],</span>
<span id="cb156-4"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb156-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">&quot;C5.0Tree&quot;</span>,</span>
<span id="cb156-5"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb156-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">tuneGrid =</span> hiperparametros,</span>
<span id="cb156-6"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb156-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">metric =</span> <span class="st">&quot;Accuracy&quot;</span>,</span>
<span id="cb156-7"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb156-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">trControl =</span> control_train)</span>
<span id="cb156-8"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb156-8" aria-hidden="true" tabindex="-1"></a>modelo_C50Tree</span></code></pre></div>
<pre><code>## Single C5.0 Tree 
## 
## 4711 samples
##   11 predictor
##    2 classes: &#39;Alta&#39;, &#39;Baja-media&#39; 
## 
## No pre-processing
## Resampling: Cross-Validated (10 fold, repeated 5 times) 
## Summary of sample sizes: 4240, 4239, 4240, 4240, 4239, 4241, ... 
## Resampling results:
## 
##   Accuracy  Kappa    
##   0.981405  0.9544161</code></pre>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo_C50Tree<span class="sc">$</span>finalModel)</span></code></pre></div>
<pre><code>## 
## Call:
## C50:::C5.0.default(x = x, y = y, weights = wts)
## 
## 
## C5.0 [Release 2.07 GPL Edition]      Mon Apr 18 13:54:20 2022
## -------------------------------
## 
## Class specified by attribute `outcome&#39;
## 
## Read 4711 cases (31 attributes) from undefined.data
## 
## Decision tree:
## 
## Engine &lt;= 1599:
## :...Seats5 &lt;= 0:
## :   :...Power &lt;= 99:
## :   :   :...Seats6 &lt;= 0: Baja-media (128/1)
## :   :   :   Seats6 &gt; 0: Alta (7)
## :   :   Power &gt; 99:
## :   :   :...Fuel_TypeDiesel &lt;= 0:
## :   :       :...Engine &lt;= 1499: Baja-media (13)
## :   :       :   Engine &gt; 1499: Alta (3)
## :   :       Fuel_TypeDiesel &gt; 0:
## :   :       :...Seats8 &lt;= 0: Alta (15)
## :   :           Seats8 &gt; 0: Baja-media (2)
## :   Seats5 &gt; 0:
## :   :...Engine &lt;= 1343:
## :       :...kmpl &gt; 18.33: Baja-media (1346/1)
## :       :   kmpl &lt;= 18.33:
## :       :   :...kmpl &lt;= 17.6: Baja-media (344)
## :       :       kmpl &gt; 17.6:
## :       :       :...Power &lt;= 77: Baja-media (60)
## :       :           Power &gt; 77:
## :       :           :...Power &lt;= 82: Alta (8)
## :       :               Power &gt; 82: Baja-media (50)
## :       Engine &gt; 1343:
## :       :...Engine &lt;= 1364: Alta (30)
## :           Engine &gt; 1364:
## :           :...Engine &gt; 1496: Baja-media (745/4)
## :               Engine &lt;= 1496:
## :               :...Engine &gt; 1493:
## :                   :...Engine &lt;= 1495: Baja-media (13)
## :                   :   Engine &gt; 1495: Alta (18)
## :                   Engine &lt;= 1493:
## :                   :...Fuel_TypeDiesel &lt;= 0: Baja-media (77/5)
## :                       Fuel_TypeDiesel &gt; 0:
## :                       :...Power &gt; 66: Baja-media (276)
## :                           Power &lt;= 66:
## :                           :...Power &lt;= 64: Baja-media (24)
## :                               Power &gt; 64: Alta (4)
## Engine &gt; 1599:
## :...Power &gt; 163.7:
##     :...Fuel_TypeDiesel &lt;= 0:
##     :   :...Power &gt; 180: Alta (96/9)
##     :   :   Power &lt;= 180:
##     :   :   :...Power &lt;= 177.01: Alta (7)
##     :   :       Power &gt; 177.01:
##     :   :       :...Engine &lt;= 1797: Alta (5)
##     :   :           Engine &gt; 1797: Baja-media (26/1)
##     :   Fuel_TypeDiesel &gt; 0:
##     :   :...kmpl &lt;= 10.93:
##     :       :...kmpl &lt;= 10.6: Alta (25)
##     :       :   kmpl &gt; 10.6: Baja-media (10)
##     :       kmpl &gt; 10.93:
##     :       :...Engine &gt; 2200: Alta (301)
##     :           Engine &lt;= 2200:
##     :           :...Engine &gt; 2149:
##     :               :...Engine &lt;= 2179: Alta (26)
##     :               :   Engine &gt; 2179: Baja-media (14)
##     :               Engine &lt;= 2149:
##     :               :...Power &gt; 167.7: Alta (326/3)
##     :                   Power &lt;= 167.7:
##     :                   :...Power &lt;= 167.62: Alta (20)
##     :                       Power &gt; 167.62: Baja-media (4)
##     Power &lt;= 163.7:
##     :...Seats8 &gt; 0: Alta (95)
##         Seats8 &lt;= 0:
##         :...Power &gt; 147.8:
##             :...kmpl &gt; 18.7: Alta (7)
##             :   kmpl &lt;= 18.7:
##             :   :...kmpl &gt; 12.9:
##             :       :...Fuel_TypeDiesel &lt;= 0: Baja-media (29)
##             :       :   Fuel_TypeDiesel &gt; 0:
##             :       :   :...Engine &lt;= 1984: Alta (3)
##             :       :       Engine &gt; 1984: Baja-media (26/2)
##             :       kmpl &lt;= 12.9:
##             :       :...Engine &lt;= 2092:
##             :           :...TransmissionManual &lt;= 0: Alta (15/3)
##             :           :   TransmissionManual &gt; 0: Baja-media (2)
##             :           Engine &gt; 2092:
##             :           :...Engine &lt;= 2400: Baja-media (17)
##             :               Engine &gt; 2400:
##             :               :...Engine &lt;= 2773: Alta (6/1)
##             :                   Engine &gt; 2773: Baja-media (6)
##             Power &lt;= 147.8:
##             :...Engine &lt;= 1997:
##                 :...Engine &lt;= 1798: Alta (45/1)
##                 :   Engine &gt; 1798:
##                 :   :...Power &lt;= 139.01:
##                 :       :...Seats5 &gt; 0: Baja-media (81/1)
##                 :       :   Seats5 &lt;= 0:
##                 :       :   :...Year &lt;= 2014: Baja-media (3)
##                 :       :       Year &gt; 2014: Alta (3)
##                 :       Power &gt; 139.01:
##                 :       :...kmpl &lt;= 14.8: Baja-media (10)
##                 :           kmpl &gt; 14.8:
##                 :           :...kmpl &lt;= 16.8: Alta (32)
##                 :               kmpl &gt; 16.8:
##                 :               :...Power &lt;= 142: Baja-media (13)
##                 :                   Power &gt; 142: Alta (6)
##                 Engine &gt; 1997:
##                 :...Year &lt;= 2011:
##                     :...Power &lt;= 120.7: Alta (31/1)
##                     :   Power &gt; 120.7:
##                     :   :...kmpl &lt;= 14.49: Baja-media (23/1)
##                     :       kmpl &gt; 14.49: Alta (4)
##                     Year &gt; 2011:
##                     :...Power &gt; 138.1: Alta (106)
##                         Power &lt;= 138.1:
##                         :...Power &gt; 136: Baja-media (9)
##                             Power &lt;= 136:
##                             :...Power &gt; 88.73: Alta (103/1)
##                                 Power &lt;= 88.73:
##                                 :...Power &lt;= 70.02: Alta (9)
##                                     Power &gt; 70.02: Baja-media (4)
## 
## 
## Evaluation on training data (4711 cases):
## 
##      Decision Tree   
##    ----------------  
##    Size      Errors  
## 
##      57   35( 0.7%)   &lt;&lt;
## 
## 
##     (a)   (b)    &lt;-classified as
##    ----  ----
##    1337    16    (a): class Alta
##      19  3339    (b): class Baja-media
## 
## 
##  Attribute usage:
## 
##  100.00% Engine
##   68.99% Seats5
##   58.01% kmpl
##   45.38% Power
##   28.27% Fuel_TypeDiesel
##   14.96% Seats8
##    6.26% Year
##    2.87% Seats6
##    0.36% TransmissionManual
## 
## 
## Time: 0.0 secs</code></pre>
<p>Empleando como modelo un árbol simple C5.0, se consigue un accuracy promedio de validación del 98’1%.</p>
</div>
<div id="random-forest" class="section level2" number="4.4">
<h2><span class="header-section-number">4.4</span> Random Forest</h2>
<p>El método ranger de caret emplea la función ranger() del paquete ranger. Este algoritmo tiene 3 hiperparámetros:</p>
<ul>
<li><p>mtry: número predictores seleccionados aleatoriamente en cada árbol.</p></li>
<li><p>min.node.size: tamaño mínimo que tiene que tener un nodo para poder ser dividido.</p></li>
<li><p>splitrule: criterio de división.</p></li>
</ul>
<p>Aunque caret también incluye el método rf con la función rf() del paquete randomForest, este último solo permite optimizar el hiperparámetro mtry.</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Hiperparámetros</span></span>
<span id="cb160-2"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb160-2" aria-hidden="true" tabindex="-1"></a>hiperparametros <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">mtry =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">7</span>),</span>
<span id="cb160-3"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb160-3" aria-hidden="true" tabindex="-1"></a>                               <span class="at">min.node.size =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">20</span>, <span class="dv">30</span>),</span>
<span id="cb160-4"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb160-4" aria-hidden="true" tabindex="-1"></a>                               <span class="at">splitrule =</span> <span class="st">&quot;gini&quot;</span>)</span>
<span id="cb160-5"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb160-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-6"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb160-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb160-7"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb160-7" aria-hidden="true" tabindex="-1"></a>seeds <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">mode =</span> <span class="st">&quot;list&quot;</span>, <span class="at">length =</span> (particiones <span class="sc">*</span> repeticiones) <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb160-8"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb160-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(particiones <span class="sc">*</span> repeticiones)) {</span>
<span id="cb160-9"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb160-9" aria-hidden="true" tabindex="-1"></a>  seeds[[i]] <span class="ot">&lt;-</span> <span class="fu">sample.int</span>(<span class="dv">1000</span>, <span class="fu">nrow</span>(hiperparametros))</span>
<span id="cb160-10"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb160-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb160-11"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb160-11" aria-hidden="true" tabindex="-1"></a>seeds[[(particiones <span class="sc">*</span> repeticiones) <span class="sc">+</span> <span class="dv">1</span>]] <span class="ot">&lt;-</span> <span class="fu">sample.int</span>(<span class="dv">1000</span>, <span class="dv">1</span>)</span></code></pre></div>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="co"># DEFINICIÓN DEL ENTRENAMIENTO</span></span>
<span id="cb161-2"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb161-2" aria-hidden="true" tabindex="-1"></a>control_train <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">&quot;repeatedcv&quot;</span>, <span class="at">number =</span> particiones,</span>
<span id="cb161-3"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb161-3" aria-hidden="true" tabindex="-1"></a>                              <span class="at">repeats =</span> repeticiones, <span class="at">seeds =</span> seeds,</span>
<span id="cb161-4"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb161-4" aria-hidden="true" tabindex="-1"></a>                              <span class="at">returnResamp =</span> <span class="st">&quot;final&quot;</span>, <span class="at">verboseIter =</span> <span class="cn">FALSE</span>,</span>
<span id="cb161-5"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb161-5" aria-hidden="true" tabindex="-1"></a>                              <span class="at">allowParallel =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="co"># AJUSTE DEL MODELO</span></span>
<span id="cb162-2"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb162-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-3"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb162-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">34220</span>)</span>
<span id="cb162-4"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb162-4" aria-hidden="true" tabindex="-1"></a>modelo_rf <span class="ot">&lt;-</span> <span class="fu">train</span>(Gama <span class="sc">~</span> ., <span class="at">data =</span> data[,<span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">10</span>,<span class="dv">13</span>,<span class="dv">14</span>,<span class="dv">15</span>)],</span>
<span id="cb162-5"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb162-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">method =</span> <span class="st">&quot;ranger&quot;</span>,</span>
<span id="cb162-6"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb162-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">tuneGrid =</span> hiperparametros,</span>
<span id="cb162-7"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb162-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">metric =</span> <span class="st">&quot;Accuracy&quot;</span>,</span>
<span id="cb162-8"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb162-8" aria-hidden="true" tabindex="-1"></a>                   <span class="at">trControl =</span> control_train,</span>
<span id="cb162-9"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb162-9" aria-hidden="true" tabindex="-1"></a>                   <span class="co"># Número de árboles ajustados</span></span>
<span id="cb162-10"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb162-10" aria-hidden="true" tabindex="-1"></a>                   <span class="at">num.trees =</span> <span class="dv">500</span>)</span>
<span id="cb162-11"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb162-11" aria-hidden="true" tabindex="-1"></a>modelo_rf</span></code></pre></div>
<pre><code>## Random Forest 
## 
## 4711 samples
##   11 predictor
##    2 classes: &#39;Alta&#39;, &#39;Baja-media&#39; 
## 
## No pre-processing
## Resampling: Cross-Validated (10 fold, repeated 5 times) 
## Summary of sample sizes: 4240, 4239, 4240, 4240, 4239, 4241, ... 
## Resampling results across tuning parameters:
## 
##   mtry  min.node.size  Accuracy   Kappa    
##   3      2             0.9507990  0.8806760
##   3      3             0.9509681  0.8810356
##   3      4             0.9509680  0.8810744
##   3      5             0.9509255  0.8810132
##   3     10             0.9499067  0.8785655
##   3     15             0.9486324  0.8754411
##   3     20             0.9471894  0.8719629
##   3     30             0.9449389  0.8663402
##   4      2             0.9646382  0.9138751
##   4      3             0.9637462  0.9117117
##   4      4             0.9634485  0.9109872
##   4      5             0.9633642  0.9108188
##   4     10             0.9611564  0.9054930
##   4     15             0.9588218  0.8998535
##   4     20             0.9565711  0.8945093
##   4     30             0.9516469  0.8825840
##   5      2             0.9750379  0.9390685
##   5      3             0.9743592  0.9374681
##   5      4             0.9741901  0.9370737
##   5      5             0.9736372  0.9357505
##   5     10             0.9719390  0.9316412
##   5     15             0.9698595  0.9266553
##   5     20             0.9668035  0.9192999
##   5     30             0.9612837  0.9060455
##   7      2             0.9835284  0.9597806
##   7      3             0.9829770  0.9584159
##   7      4             0.9830614  0.9586304
##   7      5             0.9826792  0.9577242
##   7     10             0.9816599  0.9552617
##   7     15             0.9796647  0.9504233
##   7     20             0.9780094  0.9464033
##   7     30             0.9733400  0.9349875
## 
## Tuning parameter &#39;splitrule&#39; was held constant at a value of gini
## Accuracy was used to select the optimal model using the largest value.
## The final values used for the model were mtry = 7, splitrule = gini
##  and min.node.size = 2.</code></pre>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb164-1" aria-hidden="true" tabindex="-1"></a>modelo_rf<span class="sc">$</span>finalModel</span></code></pre></div>
<pre><code>## Ranger result
## 
## Call:
##  ranger::ranger(dependent.variable.name = &quot;.outcome&quot;, data = x,      mtry = min(param$mtry, ncol(x)), min.node.size = param$min.node.size,      splitrule = as.character(param$splitrule), write.forest = TRUE,      probability = classProbs, ...) 
## 
## Type:                             Classification 
## Number of trees:                  500 
## Sample size:                      4711 
## Number of independent variables:  30 
## Mtry:                             7 
## Target node size:                 2 
## Variable importance mode:         none 
## Splitrule:                        gini 
## OOB prediction error:             1.59 %</code></pre>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="co"># REPRESENTACIÓN GRÁFICA</span></span>
<span id="cb166-2"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb166-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(modelo_rf, <span class="at">highlight =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb166-3"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb166-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">30</span>) <span class="sc">+</span></span>
<span id="cb166-4"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb166-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Evolución del accuracy del modelo Random Forest&quot;</span>) <span class="sc">+</span></span>
<span id="cb166-5"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb166-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">&quot;mtry&quot;</span>),</span>
<span id="cb166-6"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb166-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">shape =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">&quot;mtry&quot;</span>)) <span class="sc">+</span></span>
<span id="cb166-7"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb166-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="MachineLearning1_files/figure-html/unnamed-chunk-48-1.png" width="672" /></p>
<p>Empleando un modelo random forest con mtry = 7, min.node.size = 2 y splitrule = “gini”, se consigue un accuracy promedio de validación del 98’4%.</p>
</div>
<div id="svm" class="section level2" number="4.5">
<h2><span class="header-section-number">4.5</span> SVM</h2>
<p>El método svmRadial de caret emplea la función ksvm() del paquete kernlab. Este algoritmo tiene 2 hiperparámetros:</p>
<ul>
<li><p>sigma: coeficiente del kernel radial.</p></li>
<li><p>C: penalización por violaciones del margen del hiperplano.</p></li>
</ul>
<p>Se ajustan los hiperparámetros y se entrena el modelo con kernel radial:</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Hiperparámetros</span></span>
<span id="cb167-2"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb167-2" aria-hidden="true" tabindex="-1"></a>hiperparametros <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">sigma =</span> <span class="fu">c</span>(<span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="dv">1</span>),</span>
<span id="cb167-3"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb167-3" aria-hidden="true" tabindex="-1"></a>                               <span class="at">C =</span> <span class="fu">c</span>(<span class="dv">1</span> , <span class="dv">20</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">200</span>, <span class="dv">500</span>, <span class="dv">700</span>))</span>
<span id="cb167-4"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb167-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-5"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb167-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb167-6"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb167-6" aria-hidden="true" tabindex="-1"></a>seeds <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">mode =</span> <span class="st">&quot;list&quot;</span>, <span class="at">length =</span> (particiones <span class="sc">*</span> repeticiones) <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb167-7"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb167-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(particiones <span class="sc">*</span> repeticiones)) {</span>
<span id="cb167-8"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb167-8" aria-hidden="true" tabindex="-1"></a>  seeds[[i]] <span class="ot">&lt;-</span> <span class="fu">sample.int</span>(<span class="dv">1000</span>, <span class="fu">nrow</span>(hiperparametros))</span>
<span id="cb167-9"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb167-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb167-10"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb167-10" aria-hidden="true" tabindex="-1"></a>seeds[[(particiones <span class="sc">*</span> repeticiones) <span class="sc">+</span> <span class="dv">1</span>]] <span class="ot">&lt;-</span> <span class="fu">sample.int</span>(<span class="dv">1000</span>, <span class="dv">1</span>)</span></code></pre></div>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="co"># DEFINICIÓN DEL ENTRENAMIENTO</span></span>
<span id="cb168-2"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb168-2" aria-hidden="true" tabindex="-1"></a>control_train <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">&quot;repeatedcv&quot;</span>, <span class="at">number =</span> particiones,</span>
<span id="cb168-3"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb168-3" aria-hidden="true" tabindex="-1"></a>                              <span class="at">repeats =</span> repeticiones, <span class="at">seeds =</span> seeds,</span>
<span id="cb168-4"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb168-4" aria-hidden="true" tabindex="-1"></a>                              <span class="at">returnResamp =</span> <span class="st">&quot;final&quot;</span>, <span class="at">verboseIter =</span> <span class="cn">FALSE</span>,</span>
<span id="cb168-5"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb168-5" aria-hidden="true" tabindex="-1"></a>                              <span class="at">allowParallel =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="co"># AJUSTE DEL MODELO</span></span>
<span id="cb169-2"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb169-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-3"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb169-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">342</span>)</span>
<span id="cb169-4"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb169-4" aria-hidden="true" tabindex="-1"></a>modelo_svmrad <span class="ot">&lt;-</span> <span class="fu">train</span>(Gama <span class="sc">~</span> ., <span class="at">data =</span> data[,<span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">10</span>,<span class="dv">13</span>,<span class="dv">14</span>,<span class="dv">15</span>)],</span>
<span id="cb169-5"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb169-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">method =</span> <span class="st">&quot;svmRadial&quot;</span>,</span>
<span id="cb169-6"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb169-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">tuneGrid =</span> hiperparametros,</span>
<span id="cb169-7"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb169-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">metric =</span> <span class="st">&quot;Accuracy&quot;</span>,</span>
<span id="cb169-8"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb169-8" aria-hidden="true" tabindex="-1"></a>                   <span class="at">trControl =</span> control_train)</span>
<span id="cb169-9"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb169-9" aria-hidden="true" tabindex="-1"></a>modelo_svmrad</span></code></pre></div>
<pre><code>## Support Vector Machines with Radial Basis Function Kernel 
## 
## 4711 samples
##   11 predictor
##    2 classes: &#39;Alta&#39;, &#39;Baja-media&#39; 
## 
## No pre-processing
## Resampling: Cross-Validated (10 fold, repeated 5 times) 
## Summary of sample sizes: 4240, 4240, 4239, 4240, 4240, 4240, ... 
## Resampling results across tuning parameters:
## 
##   sigma  C    Accuracy   Kappa    
##   0.001    1  0.9271074  0.8244331
##   0.001   20  0.9269789  0.8236833
##   0.001   50  0.9277433  0.8254514
##   0.001  100  0.9279981  0.8257346
##   0.001  200  0.9292287  0.8283934
##   0.001  500  0.9296964  0.8290602
##   0.001  700  0.9297806  0.8289960
##   0.010    1  0.9296963  0.8298518
##   0.010   20  0.9300766  0.8287067
##   0.010   50  0.9293980  0.8270251
##   0.010  100  0.9294410  0.8270782
##   0.010  200  0.9284219  0.8245447
##   0.010  500  0.9269788  0.8206876
##   0.010  700  0.9271481  0.8208105
##   0.100    1  0.9260447  0.8192948
##   0.100   20  0.9201869  0.8035070
##   0.100   50  0.9173425  0.7958958
##   0.100  100  0.9155593  0.7916444
##   0.100  200  0.9123322  0.7840549
##   0.100  500  0.9063028  0.7695067
##   0.100  700  0.9036705  0.7629402
##   0.500    1  0.9010397  0.7500010
##   0.500   20  0.8968771  0.7400260
##   0.500   50  0.8900000  0.7235634
##   0.500  100  0.8852446  0.7115387
##   0.500  200  0.8838005  0.7079148
##   0.500  500  0.8812541  0.7010558
##   0.500  700  0.8806599  0.6992638
##   1.000    1  0.8944579  0.7267584
##   1.000   20  0.8871119  0.7111117
##   1.000   50  0.8814231  0.6968666
##   1.000  100  0.8800224  0.6931900
##   1.000  200  0.8783665  0.6888309
##   1.000  500  0.8773057  0.6860360
##   1.000  700  0.8773906  0.6861693
## 
## Accuracy was used to select the optimal model using the largest value.
## The final values used for the model were sigma = 0.01 and C = 20.</code></pre>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb171-1" aria-hidden="true" tabindex="-1"></a>modelo_svmrad<span class="sc">$</span>finalModel</span></code></pre></div>
<pre><code>## Support Vector Machine object of class &quot;ksvm&quot; 
## 
## SV type: C-svc  (classification) 
##  parameter : cost C = 20 
## 
## Gaussian Radial Basis kernel function. 
##  Hyperparameter : sigma =  0.01 
## 
## Number of Support Vectors : 878 
## 
## Objective Function Value : -13539.15 
## Training error : 0.057737</code></pre>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="co"># REPRESENTACIÓN GRÁFICA</span></span>
<span id="cb173-2"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb173-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(modelo_svmrad, <span class="at">highlight =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb173-3"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb173-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Evolución del accuracy del modelo SVM Radial&quot;</span>) <span class="sc">+</span></span>
<span id="cb173-4"><a href="ajuste-de-los-hiperparámetros-del-modelo.html#cb173-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="MachineLearning1_files/figure-html/unnamed-chunk-53-1.png" width="672" /></p>
<p>Empleando un modelo SVM Radial con sigma = 0.01 y C = 20, se consigue un accuracy promedio de validación del 93%.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="análisis-supervisado.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="evaluación-y-comparación-de-modelos.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": false,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
