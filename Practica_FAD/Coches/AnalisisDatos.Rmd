---
title: "AnalisisDatos"
author: "Amanda del Álamo & Alejandro Delgado"
date: "16/11/2021"
output: html_document
---

```{r}
library(dplyr)
# install.packages("readr")
library(readr)
# install.packages("mice")
library(mice)
#install.packages("stringr")
library(stringr)
#install.packages("ggplot2")
library(ggplot2)
#install.packages("tidyverse")
library(tidyverse)
library(gridExtra)
```


```{r}
getwd() #obtener el directorio en el que estas 
data <- read.csv("cochesdataP.csv", na = c("","NA","NULL",NULL,"  ","/n" ))
head(data)
names(data)
attach(data) #esto es para q cuando menciones una de las variables, no tengas q poner data$prize sino q puedes llamarla cuando quieras 
```

La función glimpse() del paquete dplyr puede utilizarse para ver las columnas del conjunto de datos y mostrar alguna porción de ellos con respecto a cada atributo que pueda caber en una sola línea.

```{r}
glimpse(data)
```

Con esta forma de visualización podemos observar mejor la naturaleza de los datos. Tenemos 7253 observaciones y 14 columnas y a simple vista vemos que muchos datos están bien tipados pero otros habrá que transformarlos, como puede ser el caso de la variable Mileage (Kilometraje) que está como Character ya que viene el número con su unidad de medida y habrá que decidir si ponerlo todo como km/kg o kmpl. Lo mismo nos pasa con Power (potencia) y New Price que parece tener muchos elementos faltantes. La variable Seats (asientos) es un double cuando debería ser entera... Hay muchas cosas que modificar para dar valor a estos datos.

### Name -> Nombre de las marcas y modelos de los coches.
### Location -> La ubicación en la que se vende el coche o está disponible para su compra.
### Year -> El año del modelo de coche.
### Kilometers_Driven -> El total de kilómetros recorridos en el coche por el anterior propietario en Km
### Fuel_Type -> El tipo de combustible utilizado por el coche.
### Transmission -> El tipo de transmisión utilizado por el coche.
### Owner_Type -> Indica si el coche es de primera, segunda, tercera, cuarta... mano.
### Mileage -> El kilometraje estándar ofrecido por la compañía de automóviles en kmpl o km/kg.
### Engine -> La cilindrada del motor en cc.
### Power -> La potencia máxima del motor en bhp (CV).
### Seats -> Número de asientos.
### New_Price -> El precio del coche, nuevo.
### Price -> El precio del coche usado en INR Lakhs (Rupias).

```{r}
data %>% pull(Mileage) %>% str_split(" ", simplify=TRUE) %>% cbind(Fuel_Type) %>% subset(select=2:3) %>% as.data.frame() %>% table() #Extraigo los diferentes tipos que hay y como se relacionan

data %>% pull(Engine) %>% str_split(" ", simplify=TRUE) %>% subset(select=2) %>% table() # hago lo mismo para confirmar que solo hay un tipo

data %>% pull(Power) %>% str_split(" ", simplify=TRUE) %>% subset(select=2) %>% table() # hago lo mismo para confirmar que solo hay un tipo

data %>% pull(New_Price) %>% str_split(" ", simplify=TRUE) %>% subset(select=2) %>% table()

```

AQUI TENGO QUE PONER TODO EL TEMA DE QUE HAY DOS VARIABLES Y QUE HAY QUE SEPARAR, ETC ETC ETC. LO DEJO EN BLANCO DE MOMENTO.

```{r Modificación de Datos}
data %>% mutate(Mileage = as.numeric(str_extract(Mileage, "^[:graph:]+"))) %>% 
    mutate(kmpl = ifelse(Fuel_Type=="Diesel" | Fuel_Type=="Petrol", Mileage, 0)) %>%
    mutate(kmpkg = ifelse(Fuel_Type=="CNG" | Fuel_Type=="LPG", Mileage, 0)) %>%
    select(-Mileage) -> data

data %>% mutate(Engine = as.numeric(str_extract(Engine, "^[:graph:]+"))) -> data
data %>% mutate(Power = as.numeric(str_extract(Power, "^[:graph:]+"))) -> data

data %>%
  mutate(Seats = as.integer(Seats)) %>%
  mutate(Owner_Type = factor(Owner_Type, levels=c("First", "Second", "Third", "Fourth & Above"))) -> data

data %>%
  mutate(Fuel_Type = as.factor(Fuel_Type)) %>%
  mutate(Transmission = as.factor(Transmission)) %>%
  mutate(Location = as.factor(Location)) %>%
  mutate(New_Price = as.numeric(str_extract(New_Price, "^[:graph:]+"))) -> data

attach(data)
```
##Análisis valores faltantes

A continuación vamos a ver la cantidad de valores perdidos con la función md.pattern de la librería *mice*

```{r missing data}
md.pattern(data, plot = TRUE, rotate.names=TRUE)
```


Al analizar los valores faltantes con md.pattern nos hemos dado cuenta de que algo no tenía sentido. Claramente la columna New_Price tenia valores faltantes pero no los detectaba. Esto es debido a que no estan marcados como Nan sino como valores vacíos y lo mismo nos pasa en columnas como Engine o Power, por lo tanto para saber la cantidad total de valores faltantes tendremos que contabilizar también los valores vacíos.

Vamos a buscar en qué variables y en qué medida de nuestro conjunto de datos hay algún dato del tipo `NA`

```{r encontrar NAs en el caso de que aparezcan en nuestro conjunto}
# Convertimos nuestro set de datos en un set de booleanos que contendrá TRUE en la celda en la que haya un NA
data_na = is.na(data)
#data_na
# Asignamos 1 a los valores TRUE (es decir a los NA), y sumamos todos.
vectorDeNAs = which(apply(data_na,1,sum)>0)
#vectorDeNAs
#sapply(data, function(x) sum(is.na(x)))
apply(is.na(data), 2, mean) #porcentaje na por columna  
#apply(is.na(data), 2, which)  # Posición de NA por columna
#p= dim(data)[2]
#number_na = apply(data[,-c(p-1,p)],1,function(x) sum(is.na(x)))
#table(number_na)

```
Se observa claramente que al 86% de los registros les falta datos de la variable New_price, por lo que vamos a proceder a su eliminación ya que la imputación de NA es inviable. También eliminaremos la columna 'X' ya que no es más que el indice duplicado.

```{r}
data %>% select(-New_Price) -> data
data %>% select(-X) -> data
```

Podemos volver a analizar los valores faltantes ahora que hemos eliminado la columna New_Price

```{r missing data2}
md.pattern(data, plot = TRUE, rotate.names=TRUE)
```
Como podemos ver ahora, hay 4 tipos de valores faltantes.
-36 coches que tienen valores faltantes en las columnas Engine, Seats y Power
-4 coches que tienen valores faltantes en las columnas de Seats y Power
-2 coches que no tienen datos de Seats
-103 coches que no tienen ni un solo dato de Power

```{r}
data %>% filter(is.na(Engine) | is.na(Seats) | is.na(Power))
```

Los datos faltantes se podrían rellenar buscando información en internet o completandolos con los datos de coches con el mismo nombre. Vamos a probar esto.

```{r}
data %>% filter(is.na(Engine) | is.na(Seats) | is.na(Power)) %>% pull(Name) %>% unique() -> missing_cars #guardamos los coches que tienen faltantes

data %>% group_by(Name) %>% fill(Engine, Power, Seats) %>% ungroup() -> data #sacamos de data esos coches

md.pattern(data, plot = TRUE, rotate.names=TRUE)
```

Se puede apreciar que el número de valores faltantes disminuye pero no de forma significativa. Aún tenemos más de 120 coches con valores faltantes y dado que la mayoría tiene muchas especificaciones dentro de su propio nombre, buscar los valores que faltan coche por coche es tedioso y puede que no afecte mucho al resultado final del análisis. 
Procedemos a eleminiar todos los registros con valores faltantes en lugar de imputarlos.

```{r}
data %>% drop_na() -> data
```

Por lo antes comentado de los nombres, vamos a crear una nueva variable llamada *Marca*, la razón de crear esta variable es la de separar la Marca del tipo de coche ya que ambos estan juntos en la variable *Name*.

```{r new variable}
str_split(data$Name, " ", simplify=TRUE) %>% subset(select=1) %>% unique() -> car_makes
car_makes
car_makes[car_makes=="Land"] <- "Land Rover" #Anomalía en los datos
car_makes
car_makes_regex <- paste(car_makes, collapse="|")
car_makes_regex
str_extract(data$Name, car_makes_regex) -> make
make
data %>% mutate(Make = str_to_title(make)) -> data
```

Ahora ya podemos separar el dataset en sets para train y test.

```{r train test sets} 
# 80% del tamaño de la muestra
smp_size <- floor(0.8 * nrow(data))

# establecemos la semilla para que su partición sea reproducible
set.seed(123)
train_ind <- sample(seq_len(nrow(data)), size = smp_size)

train <- data[train_ind, ]
test <- data[-train_ind, ]

rm(train_ind)
```

A partir de ahora solo trabajaremos con train

##Exploración de los datos

Nuestra variable respuesta va a ser: *Price*
Por lo que en primer lugar, vamos a ver la distribución de esta variable.

```{r}
train %>% ggplot() + 
  geom_histogram(aes(Price, ..density..), bins=80) + 
  geom_density(aes(Price))
```

La distrubución es demasiado sesgada, volvemos a probar usando una distribución logaritmica

```{r}
train %>% ggplot() + 
  geom_histogram(aes(Price, ..density..), bins=80) + 
  geom_density(aes(Price)) +
  scale_x_log10()
```

Esto remedia la asimetría, por lo que transformaremos la variable antes de modelarla. Para la exploración seguiremos utilizando la escala logarítmica, pero no transformaremos realmente la variable *Price* en el conjunto de datos.

```{r análisis variable "Year"}
class(Year)
unique(Year)
h <- hist(Year)
h
sum(Year==2002)
boxplot(Year,horizontal = TRUE)

ggplot(data, aes(x=Year)) + geom_histogram(breaks=seq(1996,2020,by=1), binwidth = 0.4,  fill="blue", colour="black")
ggplot(data, aes(x=Year)) + geom_histogram(breaks=seq(1996,2020,by=1),aes(y=..density..), binwidth = 0.4,  fill="blue", colour="black")+geom_density(colour="green", fill="green",alpha=0.3)


```

La primera variable que vamos a analizar es "Year", hace referencia al año en que se fabricó cada coche. Se trata de una variable cuantitativa,ya que podemos calcular la diferencia entre fechas, en la que aparecen los años desde 1996 hasta 2018.  Obtenemos que en el año 1998 se contabilizan 10 coches, en el año 2000, 23, en el 2004, 135. Va aumentando el número de coches progresivamente con el paso de los años hasta llegar a 2016 donde vuelve a disminuir también progresivamente. Esta variable está definida como "integer" y así la trataremos, ya que no nos da problema y nos aporta toda la información necesaria. Además, gracias al boxplot se aprecia que el 50% de los datos se encontrarán entre 2011 y 2017.

```{r analisis variable Kilometers_driven}
#install.packages("gmodels")
#install.packages("Hmisc")
#install.packages("ggthemes")
library(gmodels)
library(Hmisc)
library(ggthemes)
names(data)
class(Kilometers_Driven)
sum(Kilometers_Driven<=34000)
summary(Kilometers_Driven) #7253 es el total
boxplot(Kilometers_Driven) # ese valor atípico q sale deberiamos plantearnos q hacer con él, es un valor excesivamente alto
which(Kilometers_Driven==6500000) #posicion del valor atipico
Kilometers_Driven
kilometers <- Kilometers_Driven[-2329] #quito ese valor, solo por probar, yo le estudiaría aparte
summary(kilometers)
hist(kilometers)
boxplot(kilometers, horizontal=TRUE)
k <- hist(kilometers)
k
histograma <- ggplot(data, aes(x=kilometers)) +
  ggtitle("Kilómetros recorridos") +
  theme_fivethirtyeight() +
  geom_histogram(color="#28324a", fill="#3c78d8")
histograma

#######3scale_x_log10() meter esto al gráfico en transformación de variables 
```

La segunda variable a analizar es "Kilometers_driven", que hace referencia a los kilometros que lleva recorridos el coche. Se trata de una variable cuantitativa expresada como integer en nuestros datos. El mínimo de kilometros recorridos por un coche de los que estamos estudiando es de 171 mientras que el máximo llega hasta 6500.000. Analizándolo al detalle se aprecia que el valor máximo es un outlier ya que está muy lejos de la media y es el único coche con tantos km recorridos. Más adelante, decidiremos que hacer con ese valor, de momento, obtenemos que la media de kilometros recorridos por los coches es de 58738 y que el 50% de los datos se encuentran entre 53000 y 73000. 


```{r analisis variable Fuel_Type}
names(data)
class(Fuel_Type)
Fuel_Type
unique(Fuel_Type)
ggplot(data, aes(x=Fuel_Type)) + geom_histogram(stat="count",binwidth = 0.4,  fill="blue", colour="black", ) 
summary(Fuel_Type)
```

La tercera variable que vamos a analizar es "Fuel_Type", que hace referencia al tipo de combustible que usa cada coche. Se trata de una variable cualitativa. Está representada en nuestros datos como factor y los valores que  toma son CNG,LPG, Electric, Diesel y Pretol. Vamos a describir cada uno de los valores que toma esta variable:
    -CNG: El gas natural comprimido, más conocido por la sigla GNC, es un combustible para uso vehicular que, por ser económico y ambientalmente más limpio, es considerado una alternativa sustentable para la sustitución de combustibles líquidos.
    -LPG: El gas licuado del petróleo es la mezcla de gases licuados presentes en el gas natural o disueltos en el petróleo. Lleva consigo procesos físicos y químicos por ejemplo el uso de metano.
    -Diésel: El diésel o dísel, también denominado gasóleo o gasoil, es un hidrocarburo líquido de densidad sobre 850 kg/m³, compuesto fundamentalmente por parafinas y utilizado principalmente como combustible en calefacción y en motores diésel. Su poder calorífico inferior es de 35,86 MJ/l.
    -Petrol: La gasolina es formada con el petróleo refinado, utilizado principalmente como combustible, es esencial para la red mundial de transporte, el combustible primario que hace funcionar los motores de combustión interna que mueven la mayoría de los automóviles y otros sistemas de transporte.
    
De Electric, eléctricos es del tipo que menos muestras poseemos, sólo 2. De LPG y CNG también poseemos pocas (1 y  56 restivamente) y es en Diesel y Petrol donde tenemos la mayoría de los datos, siendo 3852 y 3325 las muestras respectivamente. 
Se muestra el histograma para visualizar la gran diferencia de muestras entre Diesel y Petróleo y las demás.

```{r análisis variable Name}
grid.arrange(
  ggplot(train, aes(reorder(Make, Price, median), Price)) +
    geom_boxplot() +
    scale_y_log10() + 
    coord_flip(),
  ggplot(train, aes(reorder(Make, Price, median))) + 
    geom_bar(stat="count") +
    theme(axis.title.y=element_blank(), axis.text.y=element_blank(), axis.ticks.y=element_blank()) +
    coord_flip(),
      ncol=3, nrow=1,
      layout_matrix=t(c(1,1,2))
)
```
###ESTE GRÁFICO AQUÍ O EN LA RELACION PRECIO-MARCA
Lo que podemos ver es que hay mas marcas baratas que caras. Las marcas más caras son las de coches de lujo y hay muy pocos coches de este tipo en este dataset. 
Por otro lado, hay muchos coches de gama media de precio decente, como Hyundai y Maruti. Esto nos da una pista de que la marca de un coche puede determinar su precio.


```{r analisis variable Location}
class(Location)
summary(Location) 
ggplot(data, aes(x=Location)) + geom_histogram(stat="count",binwidth = 0.4,  fill="blue", colour="black")
```

Otra de las variables es Location, que es la localización en que está disponible el coche para vender. Se trata de una variable cuantitativa que catalogamos como factor para estudiarla en función de las muestras que posea cada ciudad. La que menos coches disponibles tiene por el momento es Ahmedabad con 224 y le secunda Bangalore con 358 y por el otro extremo, tenemos a la ciudad de Hyderabad con 742 y Mumbai con el máximo de coches disponibles, 790. 

```{r analisis variable Transmission}
class(Transmission)
summary(Transmission)
ggplot(data, aes(x=Transmission)) + geom_histogram(stat="count",binwidth = 0.4,  fill="blue", colour="black", ordered=TRUE)
##podemos añadir tambien el porcentaje de los que son de cada tipo
```

Seguimos con el análisis univariante, ahora con "Transmission". Se trata de una variable cualitativa binaria, en la que podemos distinguir entre los coches automáticos y manuales. Una transmisión manual es una caja de cambios que no puede alterar la relación de cambio por sí sola, requiriendo la intervención del conductor para hacer esto y sin embargo, una transmisión automática es una caja de cambios de automóviles u otro tipo de vehículos que puede encargarse por sí misma de cambiar la relación de cambio automáticamente a medida que el vehículo se mueve, liberando así al conductor de la tarea de cambiar de marcha manualmente. Se tienen  muestras 1720 de automáticos y 4299 de manuales. Tenemos la variable como factor en nuestros datos, en este caso, al ser sólo dos valores, es perfecto para nuestro análisis.

```{r analisis variable Owner_Type}
class(Owner_Type)
summary(Owner_Type)
ggplot(data, aes(x=Owner_Type)) + geom_histogram(stat="count",binwidth = 0.4,  fill="blue", colour="black", ordered=TRUE)

```

La siguiente variable a analizar es "Owner_Type", que hace referencia a la clase de propietario, es decir, si el conductor está configurado como primer, segundo o tercero. Se trata de una variable cualitativa en la que podemos distinguir entre los valores: First, Second, Third y Fourth&Above. Del valor que menos muestras tenemos es Fourth&Above con 9 de ellas, después, Third con 113, y en Second y First aumentan considerablemente (968 y 4929, respectivamente) por lo que será mucho más preciso el análisis a la hora de correlacionar variables. Realizamos el histograma para apreciar la diferencia entre el número de muestras de cada tipo.


```{r analisis variable Mileage}
class(Mileage)
summary(Mileage)
ggplot(data, aes(x=Mileage)) + geom_histogram(stat="count",binwidth = 0.4,  fill="blue", colour="black", ordered=TRUE)
```

Seguimos con el análisis univariante de la variable "Mileage" que hace referencia al kilometraje del coche y está expresado en kilómetros por litro. Se trata de una variable cuantitativa continua que toma muchos y distintos valores que posteriormente agruparemos por intervalo. En nuestros datos está expresada como factor, lo mejor sería convertirlo a integer o float para así poder realizar gráficos para visualizar cada una de las muestras. No tiene sentido trabajarla como factor pero la trabajaremos más adelante. Tampoco se ha realizado el gráfico porque visualmente no ayuda.


```{r análisis variable Engine}
class(Engine)
summary(Engine)
unique(Engine)
ggplot(data, aes(x=Engine)) + geom_histogram(stat="count",binwidth = 0.2,  fill="blue", colour="black", ordered=TRUE)
```

Esta variable, "Engine", hace referencia a la cilindrada del motor. Se trata de una variable cuantitativa discreta y que está como integer en nuestros datos. El mínimo es 72 y el máximo es 5998 siendo la media 1621 y donde el 50% de las muestras las encontramos entre 1198 y 1984.

```{r analisis variable Power}
class(Power)
summary(Power)
ggplot(data, aes(x=Power)) + geom_histogram(stat="count",binwidth = 0.2,  fill="blue", colour="black", ordered=TRUE)
```

Esta variable hace referencia a la potencia del motor. Se trata de una variable cuantitativa continua en la que el mínimo es 34.2 y el máximo 560 con media 113.3 y donde el 50% de los datos se encuentran entre 75 y 138. Además, existen 143 valores faltantes que serán de gran importancia en nuestro análisis.

```{r analisis variable Seats}
class(Seats)
summary(Seats)
unique(Seats)
boxplot(Seats) # ese valor atípico q sale deberiamos plantearnos q hacer con él, es un valor excesivamente alto
Seats
hist(Seats)
boxplot(Seats, horizontal=TRUE)
s <- hist(Seats)
s
```

Esta variable "Seats" hace referencia al número de asientos que tiene el coche. Es una variable cuantitativa discreta ya que son valores exactos y además se trata como numeric, que viene perfecto para nuestro análisis. Se aprecia que aparece una de las opciones con Seats=0 cuyo valor es NA, de momento no lo tenemos en cuenta pero posteriormente valoraremos que hacer con los datos faltantes que serán también de gran importancia en nuestro análisis. La mayoría de los coches poseen 5 asientos y se le acercan también los coches de 7 y 8 plazas, mucho más comunes en personas con muchos hijos o que necesiten los coches para transportar más personas de lo "común".
Si nos fijamos en el summary como hemos dicho antes la media está en 5.28, aproximadamente 5 y contamos con 42 valores NA's.


```{r analisis variable New_price}
class(New_Price)
summary(New_Price)
unique(New_Price)
data <- data[,-12] #elimino la columna 12 q es la de NewPrice
data <- data[,-1]
```

Como hemos visto al principio, existen demasiados valores faltantes para esta variable por lo que vamos a proceder a eliminarla ya que no nos aporta información útil para nuestro análisis. También voy a eliminar la columna denominada como X ya que es un identificador que no nos aporta información simplemente numera y no nos es necesaria.

```{r analisis variable Price}
class(Price)
summary(Price)
boxplot(Price)
Price
ggplot(data, aes(x=Price)) + geom_histogram(breaks=seq(0,160,by=10), stat="count",binwidth = 0.2,  fill="blue", colour="black", ordered=TRUE)
```
La variable Price será nuestra variable respuesta. Trataremos de estimar el precio de un coche en base a todas las demás características. El precio está expresado en Rupias y en nuestros datos como numeric. Haciendo un summary vemos que el mínimo precio es de 0.440 y el máximo de 160 que al estar tan lejos de la media se entiende que hay pocos coches que tengan un precio tan alto. La media está en 9.47 rupias y el 50% de los coches tienen un precio de entre 3.5 y 9.95. 

##Correlación entre variables 

```{r}
pairs(data[,1:12],pch=19)
```

Para analizar la correlación entre variables, primero mostraremos la matriz de varianzas y covarianzas, y la matriz de correlaciones entre variables, que no aparecen al hacer `summary` y también nos proporcionan información importante.

```{r}
data <- na.omit(data) #omito na's para la correlacion, de momento
var(data) # Matriz de varianzas y covarianzas
cor(data) # Matriz de correlaciones
```

Además para ver mejor la correlación entre variables que, calculamos más arriba en la matriz de correlaciones, mostramos tres gráficos (utilizando las librerías `ellipse` y `corrplot`):

- En el primero lo que haremos será ver la correlación con elipses. Cuanto más circular sea menos correlación habrá entre las variables y cuanto más recta más correlación habrá.

- En el segundo lo que haremos será ver la correlación con una escala numérica de 0 a 10. El 0 indica ausencia de relación lineal y el 10 indica relación lineal perfecta.

- En el tercero, usando la escala que tenemos en el lateral, vemos que cuanto más oscuro y grande es el círculo, mayor relación lineal hay (azul si es positiva y rojo si es negativa), y cuanto más claro y pequeño es el círculo, menor relación lineal hay (azul si es positiva y rojo si es negativa).


```{r corr 2}
#install.packages("ellipse")
library(ellipse)
library(corrplot)
library(ggplot2)
library(ggcorrplot)
#install.packages("Hmisc")
#install.packages("corrplot")
library(corrplot)
library(Hmisc)
plotcorr(cor(data)) # Para ver la correlación mejor
plotcorr(cor(data),numbers=TRUE) # Para ver la correlación mejor
corrplot.mixed(corr = cor(data,method = "pearson"))
library(GGally)
ggpairs(data)
ggplot(data, aes(x = x, y = y, fill = valor)) +
  geom_tile(color = "black") +
  geom_text(aes(label = valor), color = "white", size = 4) +
  coord_fixed()

rcorr(as.matrix(data))
```

Con estos gráficos podemos ver rápidamente cuáles son las variables más correlacionadas con la variable respuesta y entre ellas mismas.

```{r analisis Year + Price}
library(PerformanceAnalytics)
#install.packages("PerformanceAnalytics")
ggplot(data, aes(Year, Price))+geom_boxplot(aes(group=Year))+geom_jitter(alpha=0.1)+geom_smooth(method="loess")+scale_y_log10()
dat1 <- data.frame(Year, Price)
chart.Correlation(dat1)
```

```{r analisis Name+ Price}
Name <- as.numeric(Name) #Aquí deberíamos hacer lo de clasificar todos los coches por marca, y ver si la marca influye. Asi no tiene mucho sentido
```


```{r análisis Location+Price}
ggplot(data, aes(Location, Price))+geom_boxplot(aes(group=Location))+geom_jitter(alpha=0.1)+geom_smooth(method="loess")+scale_y_log10()
```

```{r analisis Kilometers_Driven+Precio}
ggplot(data, aes(Kilometers_Driven, Price))+geom_boxplot(aes(group=Kilometers_Driven))+geom_jitter(alpha=0.1)+geom_smooth(method="loess")+scale_y_log10()
```


```{r análisis FuelType+Precio}
ggplot(data, aes(Fuel_Type, Price))+geom_boxplot(aes(group=Fuel_Type))+geom_jitter(alpha=0.1)+geom_smooth(method="loess")+scale_y_log10()
```

```{r análisis Transmission+Precio}
ggplot(data, aes(Transmission, Price))+geom_boxplot(aes(group=Transmission))+geom_jitter(alpha=0.1)+geom_smooth(method="loess")+scale_y_log10()
```


```{r análisis OwnerType + Precio}
ggplot(data, aes(Owner_Type, Price))+geom_boxplot(aes(group=Owner_Type))+geom_jitter(alpha=0.1)+geom_smooth(method="loess")+scale_y_log10()
```

```{r análisis Engine+Precio}
ggplot(data, aes(Engine, Price))+geom_boxplot(aes(group=Engine))+geom_jitter(alpha=0.1)+geom_smooth(method="loess")+scale_y_log10()
d <- data.frame(Engine, Price)
chart.Correlation(d)
```

```{r análisis Power+Precio}
ggplot(data, aes(Power, Price))+geom_boxplot(aes(group=Power))+geom_jitter(alpha=0.1)+geom_smooth(method="loess")+scale_y_log10()
dat12 <- data.frame(Power, Price)
chart.Correlation(dat12)
```


```{r  análisis Seats+Precio}
ggplot(data, aes(Seats, Price))+geom_boxplot(aes(group=Seats))+geom_jitter(alpha=0.1)+geom_smooth(method="loess")+scale_y_log10()
```

```{r análisis kmpl+Price}
ggplot(data, aes(kmpl, Price))+geom_boxplot(aes(group=kmpl))+geom_jitter(alpha=0.1)+geom_smooth(method="loess")+scale_y_log10()
dat1234 <- data.frame(kmpl, Price)
chart.Correlation(dat1234)
```


```{r análisis kmpkg+ Price} 
ggplot(data, aes(kmpkg, Price))+geom_boxplot(aes(group=kmpkg))+geom_jitter(alpha=0.1)+geom_smooth(method="loess")+scale_y_log10()
dat4 <- data.frame(kmpkg, Price)
chart.Correlation(dat4)
kmpkg
#tanto aquí como en la anterior hay que pensar qué hacer con los valores que son 0
#aplicar log al price
```












